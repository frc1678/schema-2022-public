# Used for running team calcs in Server
#
# Example:
#
# {'team_number': 29,
# 'auto_avg_hub_highs': 4.2394,
# 'auto_avg_launchpad_highs': 9.3723,
# 'auto_avg_other_highs': 8.2612,
# 'auto_avg_lows': 1.3244,
# 'tele_avg_hub_highs': 4.2394,
# 'tele_avg_launchpad_highs': 9.3723,
# 'tele_avg_other_highs': 8.2612,
# 'tele_avg_lows': 1.3244,
# 'auto_avg_balls_high': 3.8381,
# 'auto_avg_balls_total': 10.4353,
# 'tele_avg_balls_high': 92.9179,
# 'tele_avg_balls_total': 5.5324,
# 'avg_incap_time': 70.5843,
# 'avg_intakes': 14.3243,
# 'avg_exit_ball_catches': 1.3247,
# 'avg_opp_balls_scored': 8.2342,
# 'lfm_auto_avg_hub_highs': 4.2394,
# 'lfm_auto_avg_launchpad_highs': 9.3723,
# 'lfm_auto_avg_other_highs': 8.2612,
# 'lfm_auto_avg_lows': 1.3244,
# 'lfm_tele_avg_hub_highs': 4.2394,
# 'lfm_tele_avg_launchpad_highs': 9.3723,
# 'lfm_tele_avg_other_highs': 8.2612,
# 'lfm_tele_avg_lows': 1.3244,
# 'lfm_auto_avg_balls_high': 3.8381,
# 'lfm_tele_avg_balls_high': 92.9179,
# 'lfm_avg_incap_time': 5.2341,
# 'lfm_avg_exit_ball_catches': 3.3241,
# 'lfm_avg_opp_balls_scored': 5.1392,
# 'auto_sd_balls_low': 4.6602,
# 'auto_sd_balls_high': 3.2754,
# 'tele_sd_balls_low': 8.9442,
# 'tele_sd_balls_high': 2.7654,
# 'climb_all_attempts': 23,
# 'low_rung_successes': 4,
# 'mid_rung_successes': 2,
# 'high_rung_successes': 3,
# 'traversal_rung_successes': 0,
# 'position_zero_starts': 0
# 'position_one_starts': 3,
# 'position_two_starts': 9,
# 'position_three_starts': 1,
# 'position_four_starts': 0,
# 'matches_played': 10,
# 'matches_incap': 1,
# 'lfm_climb_all_attempts': 23,
# 'lfm_low_rung_successes': 4,
# 'lfm_mid_rung_successes': 2,
# 'lfm_high_rung_successes': 3,
# 'lfm_traversal_rung_successes': 0,
# 'lfm_matches_incap': 0,
# 'auto_max_balls_low': 5,
# 'auto_max_balls_high': 5,
# 'tele_max_balls_low': 5,
# 'tele_max_balls_high': 5,
# 'max_incap': 6,
# 'max_exit_ball_catches': 3,
# 'max_opp_balls_scored': 5,
# 'max_climb_level': 'HIGH',
# 'lfm_auto_max_balls_low': 5,
# 'lfm_auto_max_balls_high': 5,
# 'lfm_tele_max_balls_low': 5,
# 'lfm_tele_max_balls_high': 5,
# 'lfm_max_incap': 6,
# 'lfm_max_exit_ball_catches': 3,
# 'lfm_max_opp_balls_scored': 5,
# 'max_climb_level': 'HIGH',
# 'mode_climb_level': 'LOW',
# 'mode_start_position': 'TWO',
# 'low_avg_time': 10,
# 'mid_avg_time': 23,
# 'high_avg_time': 34,
# 'traversal_avg_time': 0,
# 'lfm_low_avg_time': 10,
# 'lfm_mid_avg_time': 23,
# 'lfm_high_avg_time': 34,
# 'lfm_traversal_avg_time': 0}
#


# Contains information about this schema file
schema_file:
  # Version of schema file
  # Incremented every merged schema change
  version: 11

# Stores fields that will be added to database but do not require calculations
data:
  team_number:
    type: int

# Averages of fields in consolidated TIMs
averages:
  auto_avg_hub_highs:
    tim_fields: [obj_tim.auto_hub_highs]
    type: float
  auto_avg_launchpad_highs:
    tim_fields: [obj_tim.auto_launchpad_highs]
    type: float
  auto_avg_other_highs:
    tim_fields: [obj_tim.auto_other_highs]
    type: float
  auto_avg_lows:
    tim_fields: [obj_tim.auto_lows]
    type: float
  tele_avg_hub_highs:
    tim_fields: [obj_tim.tele_hub_highs]
    type: float
  tele_avg_launchpad_highs:
    tim_fields: [obj_tim.tele_launchpad_highs]
    type: float
  tele_avg_other_highs:
    tim_fields: [obj_tim.tele_other_highs]
    type: float
  tele_avg_lows:
    tim_fields: [obj_tim.tele_lows]
    type: float
  auto_avg_balls_high:
    tim_fields: [obj_tim.auto_balls_high]
    type: float
  auto_avg_balls_total:
    tim_fields: [obj_tim.auto_balls_total]
    type: float
  tele_avg_balls_high:
    tim_fields: [obj_tim.tele_balls_high]
    type: float
  tele_avg_balls_total:
    tim_fields: [obj_tim.tele_balls_total]
    type: float
  avg_incap_time:
    tim_fields: [obj_tim.incap]
    type: float
  avg_intakes:
    tim_fields: [obj_tim.intakes]
    type: float
  avg_exit_ball_catches:
    tim_fields: [obj_tim.exit_ball_catches]
    type: float
  avg_opp_balls_scored:
    tim_fields: [obj_tim.opp_balls_scored]
    type: float
  lfm_auto_avg_hub_highs:
    tim_fields: [obj_tim.auto_hub_highs]
    type: float
  lfm_auto_avg_launchpad_highs:
    tim_fields: [obj_tim.auto_launchpad_highs]
    type: float
  lfm_auto_avg_other_highs:
    tim_fields: [obj_tim.auto_other_highs]
    type: float
  lfm_auto_avg_lows:
    tim_fields: [obj_tim.auto_lows]
    type: float
  lfm_tele_avg_hub_highs:
    tim_fields: [obj_tim.tele_hub_highs]
    type: float
  lfm_tele_avg_launchpad_highs:
    tim_fields: [obj_tim.tele_launchpad_highs]
    type: float
  lfm_tele_avg_other_highs:
    tim_fields: [obj_tim.tele_other_highs]
    type: float
  lfm_tele_avg_lows:
    tim_fields: [obj_tim.tele_lows]
    type: float
  lfm_auto_avg_balls_high:
    tim_fields: [obj_tim.auto_balls_high]
    type: float
  lfm_tele_avg_balls_high:
    tim_fields: [obj_tim.tele_balls_high]
    type: float
  lfm_avg_incap_time:
    tim_fields: [obj_tim.incap]
    type: float
  lfm_avg_exit_ball_catches:
    tim_fields: [obj_tim.exit_ball_catches]
    type: float
  lfm_avg_opp_balls_scored:
    tim_fields: [obj_tim.opp_balls_scored]
    type: float

# Standard deviations of fields in consolidated TIMs
# Used for predictions
standard_deviations:
  auto_sd_balls_low:
    tim_fields: [obj_tim.auto_lows]
    type: float
  auto_sd_balls_high:
    tim_fields: [obj_tim.auto_balls_high]
    type: float
  tele_sd_balls_low:
    tim_fields: [obj_tim.tele_lows]
    type: float
  tele_sd_balls_high:
    tim_fields: [obj_tim.tele_balls_high]
    type: float

# Counts of occurrences in consolidated TIMs
counts:
  climb_all_attempts:
    tim_fields:
      not:
        obj_tim.climb_time: 0
    type: int
  low_rung_successes:
    tim_fields:
      obj_tim.climb_level: 'LOW'
    type: int
  mid_rung_successes:
    tim_fields:
      obj_tim.climb_level: 'MID'
    type: int
  high_rung_successes:
    tim_fields:
      obj_tim.climb_level: 'HIGH'
    type: int
  traversal_rung_successes:
    tim_fields:
      obj_tim.climb_level: 'TRAVERSAL'
    type: int
  position_zero_starts:
    tim_fields:
      obj_tim.start_position: 'ZERO'
    type: int
  position_one_starts:
    tim_fields:
      obj_tim.start_position: 'ONE'
    type: int
  position_two_starts:
    tim_fields:
      obj_tim.start_position: 'TWO'
    type: int
  position_three_starts:
    tim_fields:
      obj_tim.start_position: 'THREE'
    type: int
  position_four_starts:
    tim_fields:
      obj_tim.start_position: 'FOUR'
    type: int
  matches_played:
    tim_fields:
      not:
        match_number: 0
    type: int
  matches_incap:
    tim_fields:
      not:
        obj_tim.incap: 0
    type: int
  lfm_climb_all_attempts:
    tim_fields:
      not:
        obj_tim.climb_time: 0
    type: int
  lfm_low_rung_successes:
    tim_fields:
      obj_tim.climb_level: 'LOW'
    type: int
  lfm_mid_rung_successes:
    tim_fields:
      obj_tim.climb_level: 'MID'
    type: int
  lfm_high_rung_successes:
    tim_fields:
      obj_tim.climb_level: 'HIGH'
    type: int
  lfm_traversal_rung_successes:
    tim_fields:
      obj_tim.climb_level: 'TRAVERSAL'
    type: int
  lfm_matches_incap:
    tim_fields:
      not:
        obj_tim.incap: 0
    type: int

# Objective counts collected by Super Scouts
super_counts:
  matches_scored_far:
    type: int
    tim_fields: [subj_tim.scored_far]

# Maximum or minimum values in consolidated TIMs
extrema:
  auto_max_balls_low:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_lows]
  auto_max_balls_high:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_balls_high]
  tele_max_balls_low:
    extrema_type: max
    tim_fields: [obj_tim.tele_lows]
    type: int
  tele_max_balls_high:
    extrema_type: max
    tim_fields: [obj_tim.tele_balls_high]
    type: int
  max_incap:
    extrema_type: max
    tim_fields: [obj_tim.incap]
    type: int
  max_exit_ball_catches:
    extrema_type: max
    tim_fields: [obj_tim.exit_ball_catches]
    type: int
  max_opp_balls_scored:
    extrema_type: max
    tim_fields: [obj_tim.opp_balls_scored]
    type: int
  max_climb_level:
    extrema_type: max
    tim_fields: [obj_tim.climb_level]
    type: str
  lfm_auto_max_balls_low:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_lows]
  lfm_auto_max_balls_high:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_balls_high]
  lfm_tele_max_balls_low:
    extrema_type: max
    tim_fields: [obj_tim.tele_lows]
    type: int
  lfm_tele_max_balls_high:
    extrema_type: max
    tim_fields: [obj_tim.tele_balls_high]
    type: int
  lfm_max_incap:
    extrema_type: max
    tim_fields: [obj_tim.incap]
    type: int
  lfm_max_exit_ball_catches:
    extrema_type: max
    tim_fields: [obj_tim.exit_ball_catches]
    type: int
  lfm_max_opp_balls_scored:
    extrema_type: max
    tim_fields: [obj_tim.opp_balls_scored]
    type: int
  lfm_max_climb_level:
    extrema_type: max
    tim_fields: [obj_tim.climb_level]
    type: str

# Most common values
modes:
  mode_climb_level:
    tim_fields: [obj_tim.climb_level]
    ignore: None
    type: List
  mode_start_position:
    tim_fields: [obj_tim.start_position]
    ignore: 'ZERO'
    type: List
  lfm_mode_start_position:
    tim_fields: [obj_tim.start_position]
    ignore: 'ZERO'
    type: List

# Special calculations for climb times of different levels
climb_times:
  low_avg_time:
    tim_fields:
      obj_tim.climb_level: 'LOW'
    type: float
  mid_avg_time:
    tim_fields:
      obj_tim.climb_level: 'MID'
    type: float
  high_avg_time:
    tim_fields:
      obj_tim.climb_level: 'HIGH'
    type: float
  traversal_avg_time:
    tim_fields:
      obj_tim.climb_level: 'TRAVERSAL'
    type: float
  lfm_low_avg_time:
    tim_fields:
      obj_tim.climb_level: 'LOW'
    type: float
  lfm_mid_avg_time:
    tim_fields:
      obj_tim.climb_level: 'MID'
    type: float
  lfm_high_avg_time:
    tim_fields:
      obj_tim.climb_level: 'HIGH'
    type: float
  lfm_traversal_avg_time:
    tim_fields:
      obj_tim.climb_level: 'TRAVERSAL'
    type: float

success_rates:
  climb_percent_success:
    team_successes: [low_rung_successes, mid_rung_successes, high_rung_successes, traversal_rung_successes]
    team_attempts: [climb_all_attempts]
    type: float
  lfm_climb_percent_success:
    team_successes: [lfm_low_rung_successes, lfm_mid_rung_successes, lfm_high_rung_successes, lfm_traversal_rung_successes]
    team_attempts: [lfm_climb_all_attempts]
    type: float
